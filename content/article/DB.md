# データベース設計
## データベース設計とは
- データを形式化する作業のこと
- ①データベース論理設計 ②データベース物理設計 ③性能設計 の手順で進め、その後DB構築をする

### ①データベース論理設計
- DBの論理構造（利用者からみたデータベースの構造）を設計
- 業務担当者からヒアリングした業務概要やデータベース化ニーズ、または業務で使用する伝票類をもとに設計する
- 成果物：ER図

### ②データベース物理設計
- DBの物理設計（ハードディスクに対するデータの格納形式）を設計
- データベースの物理構造はDBMS製品によって異なるため、使用する製品に基づいて設計する

### ③性能設計
- 性能向上を目的に、DBMS製品の機能を最適に利用できるようパラメータの値を設計

### ④データベース構築
- 性能設計の結果を反映し、コンピュータ上にデータベースを構築

## データベース論理設計の方法
どちらの手法でも、最後に他方の手法のアプローチ視点から確認が必要
### トップダウンアプローチ
概要から詳細の順にデータベース設計を行う
- メリット
  - あるべき姿の業務からデータを検討するため、理想的なデータベースを作成しやすい
- デメリット
  - 作成には業務知識やモデリングの知識、経験が必要
1. 実体の抽出<br>
業務担当者から、業務使用やデータベース化ニーズなどをヒアリング
2. 識別子の定義<br>
各実体の識別子を定義<br>
識別子：様々な対象から特定の一つを識別、特定するのにも一いられる名前や符号、数字などのこと
3. 関連の明確化<br>
実体間の関連を明確にする
4. 属性（データ項目）の定義<br>
各実体の属性を定義<br>
*識別子と属性の違いとは？*
: 識別子となる属性が主キー。属性＝被りあり、識別子＝一意にインスタンスを区別できる値
5. 確認<br>
伝票や画面などから、実体や属性に漏れがないかどうかを確認する<br>
各実体が第三正規形の条件を満たしているかを確認し、満たしていなければ正規化を行う


### ボトムアップアプローチ
データ項目の洗い出しと定義から行う<br>
伝票や画面などを入力にした「正規化」が主な作業
- メリット
  - 初心者でも比較的モデリングがしやすい
  - 伝票や画面といった目に見えるものからデータを抽出するため、データ項目の抜けが発生しにくい
- デメリット
  - 現行システムのデータ構造に影響されやすい
  - 全くの新規事業の場合、画面設計などが完成していないと着手できない
1. 属性の洗い出しと定義<br>
現行業務の伝票や画面などから属性を洗い出して定義<br>
＝データ項目を洗い出して意味内容を定義
2. リレーションの抽出<br>
1枚の伝票が１行になるようにリレーションを抽出する
3. 正規化<br>
抽出したリレーションを第三正規形になるまで正規化
4. 重複実体の結合<br>
①～③の手順の作業は伝票や画面ごとに行うため、意味が同じ実体が複数現れる<br>
＝重複するものを結合する
5. 確認<br>
業務担当者からデータベース化ニーズなどが他にないか確認し、新たなニーズが顕在化した場合はER図に追加する

## ER図
- 実体とその関連でシステムを表現
- 実体の要素をインスタンスと呼ぶ
- IDEF1Xによる表現が一般的
### 実体の種類
-  独立実体：<br>
自身の主キーにほかの実態の主キーを含まない実体であり、識別をほかの実体に依存しない<br>
角のある四角で表現<br>
実体間の関連が依存ではない場合、関連の線は破線で記述
- 依存実体：<br>
自身の主キーにほかの実体の主キーを含む実体であり、存在と識別が他の実体に依存する<br>
角が丸い四角で表現<br>
実体間の関連が依存の場合、関連の線は実戦で記述

### 関連の表現方法
- 関連には、インスタンスとインスタンスとの対応関係を表す最大値と最小値を明示する
  - カーディナリティ：対応関係の最大値、単数か複数か
    - 複数のほうに「●」をつける
  - オプショナリティ：対応関係の最小値、０か１
- 外部キーには(FK)を記載
- ロール名：外部キーによって表現する関連の内容。「ロール名.外部キー」と記述

